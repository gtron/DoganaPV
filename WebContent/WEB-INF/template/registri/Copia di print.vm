#parse('costanti.vm')
<html>
<head>
<title>$htmlTitle</title>


#if( $!addCss )#foreach( $j in $addCss )
<link rel="stylesheet" type="text/css" href="#if(!$j.startsWith('http:'))$wwwRoot#end$j" />
#end#end

<script type="text/javascript" src="$wwwRoot/js/jquery.js"></script>
#if( $!addJs )#foreach( $j in $addJs )
<script type="text/javascript" src="#if(!$j.startsWith('http:'))$wwwRoot#end$j"></script>
#end#end
#*
<link media="screen" href="$wwwRoot/style/main_v2.css" type="text/css" rel="stylesheet" />
<link media="print" href="$wwwRoot/style/printer.css" type="text/css" rel="stylesheet" />*#
<style type="text/css">

HTML {}
BODY {
font-size : 10pt ;
font-family : Arial;
margin:	0;
padding: 15mm 0 0 0;
width:279mm;
height: 190mm;
}
TABLE{ 
width:260mm;margin:0 auto;
font-size:1em; border : 2px solid #000; border-collapse: collapse;  }
TH { border: 1px solid #000 ; font-size:0.9em;}
TD { text-align: right; border: 1px solid #000 ; padding: 1pt 2pt;}
TD.l { text-align: left; }
TD.c { text-align: center; }
.pb {page-break-after: always ;}
</style>

<script type="text/javascript">
var from = 0 ;
var to = 0 ;
</script>
</head>

<body>
#set($sumSecco = 0)
#set($sumUmido = 0)
#foreach( $m in $list )
#if($velocityCount % $righePerPagina == 1 )
#if($velocityCount > 1 )</table>#end
#if($velocityCount > 2 )<div class="pb">&nbsp;</div>#end
<table border="0" class="movimenti" cellpadding="2" cellspacing="0" id="tablemovimenti">
<thead>
<tr>
<th rowspan="2" style="width:40pt;">
<script type="text/javascript">from = $m.NumRegistro</script>
Num.</th>
<th rowspan="2" style="width:50pt;">Data</th>
<th rowspan="2">Documento</th>
<th rowspan="2">N.Cons.</th>
<th rowspan="2">N.Part.</th>
<th rowspan="2">Merce</th>
<th colspan="2" style="width:40mm;">Umido</th>
<th rowspan="2" style="width:1pt;"></th>
<th colspan="2" style="width:40mm;">Secco</th>
#if ( $isIva )
<th rowspan="2" style="width:1pt;"></th>
<th colspan="2" style="width:40mm;">Valore</th>
#end
<th colspan="2" style="width:40mm;">Note</th>
</tr>
<tr>
<th>Entrata</th>
<th>Uscita</th>
<th>Entrata</th>
<th>Uscita</th>
#if ( $isIva )
<th>&euro;</th>
<th>$</td>
#end
</tr></thead>
#end
#if($velocityCount == $list.size() )<script type="text/javascript">to = $m.NumRegistro</script>#end
<tr#if($velocityCount%2  == 0) class="odd"#end>
<td class="c">$m.NumRegistro</td>
<td>$tools.Date.format($dateFormat, $m.Data).toUpperCase()</td>
<td class="c">#if($m.Documento)$m.Documento#else - #end#if($m.DocumentoPV)<br />($m.DocumentoPV)#end</td>
<td class="c">$!m.Consegna.Numero</td>
<td class="c">$!m.Consegna.NumeroPartitario</td>
<td class="l">$!m.Consegna.Merce.Nome</td>

#if($m.getIsScarico() ||  $m.Umido.intValue() < 0 )
<td>&nbsp;</td>
#if( $m.Umido.intValue() >= 0 )
<td class="r">$tools.Number.format($m.Umido)</td>
#else
<td class="r">$!tools.Number.format($tools.Math.mul( -1 , $m.Umido))</td>
#end
#else
<td class="r">$tools.Number.format($m.Umido)</td>
<td>&nbsp;</td>
#end

<td>&nbsp;</td>

#if($m.getIsScarico() ||  $m.Secco.intValue() < 0 )
<td>&nbsp;</td>
#if( $m.Secco.intValue() >= 0 )
<td class="r">$tools.Number.format($m.Secco)</td>
#else
<td class="r">$!tools.Number.format($tools.Math.mul( -1 , $m.Secco))</td>
#end
#else
<td class="r">$tools.Number.format($m.Secco)</td>
<td>&nbsp;</td>
#end

#if ( $isIva )
<td>&nbsp;</td>
<td class="r">$!tools.Number.format('#,##0',$m.ValoreEuro )</td>
<td class="r">$!tools.Number.format('#,##0',$m.ValoreDollari )</td>
#end

<td class="l">$!m.Note</td>
</tr>
#end
</table>
##
<script type="text/javascript">
try{
window.print();

// parent.printIFrame(from, to);
}
catch( e) { alert( 'Frame:' + e.message); }
</script>
</body></html>